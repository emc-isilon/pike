<?xml version="1.0" encoding="utf-8"?>
<SMB2>

  <TC>
    <Desc>WriteTC001 - Write request Structure Size = 49</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode>0x0001</SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects>DIALECT_SMB2_1</Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode>0x0001</SecurityMode>
        <DialectRevision>DIALECT_SMB2_1</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>:
        <Reserved2> </Reserved2> <Buffer> </Buffer> </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType> </ShareType>
        <Reserved> </Reserved>
        <ShareFlags> </ShareFlags>
        <Capabilities> </Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC001_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC001_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction> </CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>4</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC002 - Write request Structure Size greater than 49</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode>0x0001</SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode>0x0001</SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags> </ShareFlags>
        <Capabilities> </Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC002_1MBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC002_1MBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>50</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>16</Length>
        <Offset>1</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC003 - Write request Structure Size less than 49</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode>0x0001</SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode>0x0001</SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags> </ShareFlags>
        <Capabilities> </Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC003_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC003_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>48</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>16</Length>
        <Offset>1</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC004 - Write request Structure = 0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode>0x01</SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC004_1MBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC004_1MBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>0</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>16</Length>
        <Offset>1</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
<!--  <TC>
    <Desc>WriteTC005 - Write request StructureSize less than 0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode>0x01</SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC005_1MBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC005_1MBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>-1</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>16</Length>
        <Offset>1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC> 
  <TC>
    <Desc>WriteTC006 - Write Request Length&lt;0, Offset&lt;0, DataOffset&lt;0, Buffer Empty</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode>0x01</SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC006_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC006_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>-1</DataOffset>
        <Length>-1</Length>
        <Offset>-1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_BUFFER_OVERFLOW</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC007 - Write Request Length&lt;0, Offset=0, DataOffset=0, Buffer=Valid</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC007_1MBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC007_1MBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>0</DataOffset>
        <Length>-1</Length>
        <Offset>0</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_BUFFER_OVERFLOW</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC008 - Write Request Length&lt;0, Offset=MOF, DataOffset=Correct value, Buffer=arbitrarily large.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC008_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC008_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>-1</Length>
        <Offset>256</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile5MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_FILE_CLOSED</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC> 
  <TC>
    <Desc>WriteTC009 - Write Request Length&lt;0, Offset=EOF, Correct Value&lt;DataOffset&lt;Packet Length, Buffer=Empty</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC009_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC009_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>120</DataOffset>
        <Length>-1</Length>
        <Offset>51200</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_BUFFER_OVERFLOW</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC010 - Write Request Length&lt;0, Offset&gt;EOF, DataOffset&gt;Packet Length, Buffer=Empty</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC010_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC010_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>10000</DataOffset>
        <Length>-1</Length>
        <Offset>51300</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_BUFFER_OVERFLOW</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC011 - Write Request Length=0, Offset=0, DataOffset&lt;0, Buffer=arbitrarily large contents.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC011_128KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC011_128KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>-1</DataOffset>
        <Length>0</Length>
        <Offset>0</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile1MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC012 - Write Request Length=0, Offset&lt;0, DataOffset=0, Buffer=Empty.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC012_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC012_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>0</DataOffset>
        <Length>0</Length>
        <Offset>-1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
  <TC>
    <Desc>WriteTC013 - Write Request Length=0, Offset=EOF, DataOffset=Correct Value, Buffer=Valid.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC013_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC013_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>0</Length>
        <Offset>51200</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC014 - Write Request Length=0, Offset=MOF, Correct Value&lt;DataOffset&lt;Packet Length, Buffer=Valid.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC014_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC014_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>200</DataOffset>
        <Length>0</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
<!--  <TC>
    <Desc>WriteTC015 - Write Request Length=0, Offset&lt;0, DataOffset&gt;Packet Length, Buffer=Valid.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC015_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC015_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>1000</DataOffset>
        <Length>0</Length>
        <Offset>-1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC016 - Write Request Length=1, Offset=MOF, DataOffset&lt;0, Buffer=Empty.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC016_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC016_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>-1</DataOffset>
        <Length>1</Length>
        <Offset>2048</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC017 - Write Request Length=1, Offset=EOF, DataOffset=0, Buffer=Arbitrarily Large Contents.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC017_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC017_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>0</DataOffset>
        <Length>1</Length>
        <Offset>51200</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile1MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC018 - Write Request Length=1, Offset&lt;0, DataOffset=Correct Value, Buffer=Empty.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC018_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC018_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>1</Length>
        <Offset>-1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
  <TC>
    <Desc>WriteTC019 - Write Request Length=1, Offset=0, Correct Value&lt;DataOffset&lt;Packet Length, Buffer=Empty.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC019_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC019_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>120</DataOffset>
        <Length>1</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC020 - Write Request Length=1, Offset=0, DataOffset&gt;Packet Length, Buffer=Valid.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC020_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC020_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>2000</DataOffset>
        <Length>1</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
<!--  <TC>
    <Desc>WriteTC021 - Write Request Length&lt;Buffer Length, Offset=EOF, DataOffset&lt;0, Buffer=Valid.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC021_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC021_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>-1</DataOffset>
        <Length>512</Length>
        <Offset>51200</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>

  <TC>
    <Desc>WriteTC022 - Write in empty file with Offset =Maximum value (FFFFFFFF), Length=1byte</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC022_EmptyFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC022_EmptyFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>1</Length>
        <Offset>4294967294</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus> </ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
-->
 <!--  <TC>
    <Desc>WriteTC024 - Write Request Length&lt;Buffer Length, Offset&lt;0, Correct Value&lt;DataOffset&lt;Packet Length, Buffer=Arbitrarily Large Contents.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC024_128KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC024_128KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>128</DataOffset>
        <Length>1024</Length>
        <Offset>-1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile1MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
 <TC>
    <Desc>WriteTC025 - Write Request Length&lt;Buffer Length, Offset=MOF, DataOffset&gt;Packet Length, Buffer=Arbitrarily Large Contents.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC025_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC025_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>5000</DataOffset>
        <Length>1024</Length>
        <Offset>256</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile5MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
<!--  <TC>
    <Desc>WriteTC026 - Write Request Length=Buffer Length, Offset&gt;EOF, DataOffset&lt;0, Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC026_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC026_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>-1</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC027 - Write Request Length=Buffer Length, Offset&lt;0, DataOffset=0, Empty Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC027_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC027_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>0</DataOffset>
        <Length>512</Length>
        <Offset>-1</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
  <!--<TC>
    <Desc>WriteTC028 - Write Request Length=500, Offset=0, DataOffset=Correct Value, Arbitrarily Large Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC028_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC028_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>500</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile5MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
  <TC>
    <Desc>WriteTC029 - Write Request Length=Buffer Length, Offset=MOF, Correct Value&lt;DataOffset&lt;Packet Length, Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC029_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC029_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>64000</DataOffset>
        <Length>512</Length>
        <Offset>256</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile512B</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <!--<TC>
    <Desc>WriteTC030 - Write Request Length=Buffer Length, Offset=EOF, DataOffset&gt;Packet Length, Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC030_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC030_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>50</DataOffset>
        <Length>512</Length>
        <Offset>512</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile512B</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
  <TC>
    <Desc>WriteTC031 - Write Request Length&gt;Buffer Length, Offset=0, Correct DataOffset and Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC031_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC031_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>513</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile512B</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC032 - Write Request Length=0, Offset&gt;EOF, Correct DataOffset and Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC032_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC032_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>0</Length>
        <Offset>10000</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC033 - Write Request Length=1, Offset&gt;EOF, Correct DataOffset and Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC033_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC033_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>1</Length>
        <Offset>10000</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC034 - Write Request Length&lt;Buffer Length, Offset&gt;EOF, Correct DataOffset and Valid Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC034_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC034_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>128</Length>
        <Offset>10000</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC035 - Write Request Length=SMB2 Packet Length+ Write Request Structure Length, Offset&gt;EOF, DataOffset=0 and Empty Buffer</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC035_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC035_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>0</DataOffset>
        <Length>113</Length>
        <Offset>1000</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFileEmpty</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_INVALID_PARAMETER</ReturnStatus>
      <ValidationMechanism> </ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC036 - Write request Valid FileId</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC036_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC036_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>5</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC037 - Write request Invalid FileId - 0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC037_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC037_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId>0</FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_FILE_CLOSED</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC037a - Write request Invalid FileId - 0xFFFFFFFF</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC037a_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC037a_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId>0xFFFFFFFF</FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_FILE_CLOSED</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC037b - Write request Invalid FileId - 0xFFFFFFFF01</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC037b_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC037b_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId>0xFFFFFFFF01</FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_FILE_CLOSED</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC037c - Write request Invalid FileId - 0xFFFFFFFFFFFFFFFF</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC037c_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC037c_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId>0xFFFFFFFF01</FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_FILE_CLOSED</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <!-- WriteTC038 is covered already as all other TCs are using channel = 0 -->
  <TC>
    <Desc>WriteTC039 - Write request Channel &gt;0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel>0</Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC039_1MBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC039_1MBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>1</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC040 - Write request RemainingBytes positive</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC040_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC040_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>1</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
<!--  <TC>
    <Desc>WriteTC041 - Write request Remaining Bytes &lt; 0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC041_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC041_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>-1</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>-->
  <TC>
    <Desc>WriteTC042 - Write request RemainingBytes maximum limit.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC042_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC042_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>4294967295</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <!-- WriteTC043 and WriteTC044 are already covered as all other TCs are using RemainingBytes = 0 and WriteChannelInfoLength = 0. -->
  <TC>
    <Desc>WriteTC045 - Write request WriteChannelInfoOffset &gt; 0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC045_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC045_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>1</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <!-- WriteTC46 is already covered because all the other TCs are using WriteChannelInfoLength = 0 -->
  <TC>
    <Desc>WriteTC047 - Write request WriteChannelInfoLength &gt; 0</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC047_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC047_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>1</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>

<TC>
    <Desc>WriteTC048 - Write request Validating Flag Value for SMB 2.1 dialect</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects>DIALECT_SMB2_1</Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_1</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC048_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC048_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
<!--
<TC>
    <Desc>WriteTC048a - Write request Validating Flag Value for 2.002 dialect</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects>DIALECT_SMB2_002</Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC048a_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC048a_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>512</Length>
        <Offset>1024</Offset>
        <FileId> </FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
-->
<TC>
    <Desc>WriteTC049 - Write request Overwrite existing file</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode>0x0001</SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode>0x0001</SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>:
        <Reserved2> </Reserved2> <Buffer> </Buffer> </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType> </ShareType>
        <Reserved> </Reserved>
        <ShareFlags> </ShareFlags>
        <Capabilities> </Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC049_512BytesFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OVERWRITE_IF</CreateDisposition>
        <CreateOptions>0x00000001</CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC049_512BytesFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction> </CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>16</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
  <TC>
    <Desc>WriteTC050 - Write Request Length&lt;Buffer Length, Offset=0, DataOffset=Correct Value, Buffer=Arbitrarily Large Contents.</Desc>
    <SMB2Negotiate>
      <NegotiateRequest>
        <StructureSize>36</StructureSize>
        <DialectCount> </DialectCount>
        <SecurityMode> </SecurityMode>
        <Reserved> </Reserved>
        <Capabilities>0</Capabilities>
        <ClientGuid> </ClientGuid>
        <ClientStartTime> </ClientStartTime>
        <Dialects> </Dialects>
      </NegotiateRequest>
      <NegotiateResponse>
        <StructureSize>65</StructureSize>
        <SecurityMode> </SecurityMode>
        <DialectRevision>DIALECT_SMB2_002</DialectRevision>
        <Reserved> </Reserved>
        <ServerGuid> </ServerGuid>
        <Capabilities>0</Capabilities>
        <MaxTransactSize> </MaxTransactSize>
        <MaxReadSize> </MaxReadSize>
        <MaxWriteSize> </MaxWriteSize>
        <SystemTime> </SystemTime>
        <ServerStartTime> </ServerStartTime>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Reserved2> </Reserved2>
        <Buffer> </Buffer>
      </NegotiateResponse>
    </SMB2Negotiate>
    <SMB2SessionSetup>
      <SessionSetupRequest>
        <StructureSize>25</StructureSize>
        <Flags> </Flags>
        <SecurityMode> </SecurityMode>
        <Capabilities>0</Capabilities>
        <Channel> </Channel>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <PreviousSessionId> </PreviousSessionId>
        <Buffer> </Buffer>
      </SessionSetupRequest>
      <SessionSetupResponse>
        <StructureSize>9</StructureSize>
        <SessionFlags>0x0001</SessionFlags>
        <SecurityBufferOffset> </SecurityBufferOffset>
        <SecurityBufferLength> </SecurityBufferLength>
        <Buffer> </Buffer>
      </SessionSetupResponse>
    </SMB2SessionSetup>
    <SMB2TreeConnect>
      <TreeConnectRequest>
        <StructureSize>9</StructureSize>
        <Reserved> </Reserved>
        <PathOffset> </PathOffset>
        <PathLength> </PathLength>
        <Buffer> </Buffer>
      </TreeConnectRequest>
      <TreeConnectResponse>
        <StructureSize>16</StructureSize>
        <ShareType>0x01</ShareType>
        <Reserved> </Reserved>
        <ShareFlags>0x00000010</ShareFlags>
        <Capabilities>0x00000008</Capabilities>
        <MaximalAccess> </MaximalAccess>
      </TreeConnectResponse>
    </SMB2TreeConnect>
    <SMB2Create>
 			<CreateContextRequest>
				<CreateContextMaximalAccess></CreateContextMaximalAccess>
				<CreateContextExtendedAttribute></CreateContextExtendedAttribute>
				<CreateContextAllocationSize></CreateContextAllocationSize>
				<CreateContextDurableRequest></CreateContextDurableRequest>
				<CreateContextDurableReconnect></CreateContextDurableReconnect>
				<CreateContextSecurityDescriptor></CreateContextSecurityDescriptor>
			</CreateContextRequest> 

      <TestBed>TC023_50KBFile</TestBed>
      <CreateRequest>
        <StructureSize>57</StructureSize>
        <SecurityFlags> </SecurityFlags>
        <RequestedOplockLevel> </RequestedOplockLevel>
        <ImpersonationLevel> </ImpersonationLevel>
        <SmbCreateFlags> </SmbCreateFlags>
        <Reserved> </Reserved>
        <DesiredAccess>FILE_WRITE_DATA</DesiredAccess>
        <FileAttributes> </FileAttributes>
        <ShareAccess>FILE_SHARE_WRITE</ShareAccess>
        <CreateDisposition>FILE_OPEN_IF</CreateDisposition>
        <CreateOptions> </CreateOptions>
        <NameOffset> </NameOffset>
        <NameLength> </NameLength>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer>TC023_50KBFile</Buffer>
      </CreateRequest>
      <CreateResponse>
        <StructureSize>89</StructureSize>
        <OplockLevel> </OplockLevel>
        <Flags> </Flags>
        <CreateAction>0x00000001</CreateAction>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
        <Reserved2> </Reserved2>
        <FileId> </FileId>
        <CreateContextsOffset> </CreateContextsOffset>
        <CreateContextsLength> </CreateContextsLength>
        <Buffer> </Buffer>
      </CreateResponse>
    </SMB2Create>
    <SMB2Write>
      <WriteRequest>
        <StructureSize>49</StructureSize>
        <DataOffset>112</DataOffset>
        <Length>1024</Length>
        <Offset>0</Offset>
        <FileId></FileId>
        <Channel>0</Channel>
        <RemainingBytes>0</RemainingBytes>
        <WriteChannelInfoOffset>0</WriteChannelInfoOffset>
        <WriteChannelInfoLength>0</WriteChannelInfoLength>
        <Flags>0</Flags>
        <Buffer>WriteInputFile1MB</Buffer>
      </WriteRequest>
      <WriteResponse>
        <StructureSize>17</StructureSize>
        <Reserved> </Reserved>
        <Count> </Count>
        <Remaining> </Remaining>
        <WriteChannelInfoOffset> </WriteChannelInfoOffset>
        <WriteChannelInfoLength> </WriteChannelInfoLength>
      </WriteResponse>
    </SMB2Write>
    <Result>
      <Cmd>Write</Cmd>
      <ReturnStatus>STATUS_SUCCESS</ReturnStatus>
      <ValidationMechanism>chksum</ValidationMechanism>
    </Result>
    <SMB2Close>
      <CloseRequest>
        <StructureSize>24</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <FileId> </FileId>
      </CloseRequest>
      <CloseResponse>
        <StructureSize>60</StructureSize>
        <Flags> </Flags>
        <Reserved> </Reserved>
        <CreationTime> </CreationTime>
        <LastAccessTime> </LastAccessTime>
        <LastWriteTime> </LastWriteTime>
        <ChangeTime> </ChangeTime>
        <AllocationSize> </AllocationSize>
        <EndofFile> </EndofFile>
        <FileAttributes> </FileAttributes>
      </CloseResponse>
    </SMB2Close>
    <SMB2TreeDisconnect>
      <TreeDisconnectRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectRequest>
      <TreeDisconnectResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </TreeDisconnectResponse>
    </SMB2TreeDisconnect>
    <SMB2LOGOFF>
      <LOGOFFRequest>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFRequest>
      <LOGOFFResponse>
        <StructureSize>4</StructureSize>
        <Reserved> </Reserved>
      </LOGOFFResponse>
    </SMB2LOGOFF>
  </TC>
</SMB2>
