
#--------------------------------------
# Name:        FileOpenTestBed.py
# Purpose:
#
# Abstract:
#
#        This Script performs xml parsing for filename and file attributes and
#        Creates the testbed for all Create File Open test cases.
#        This testbed + FileOpenTestBed.xml file must be copied on the shared
#        folder on the windows machine (e.g \\servername\OpenFile) and then
#        the test is executed
#
# Author:     Sagar Naik ( sagar.naik@clasoftinc.com )
#
#--------------------------------------

import xml.etree.ElementTree as ET

from ctypes import *
handle = windll.kernel32

tree = ET.parse("FileOpenTestBed.xml")
for tc in  tree.getiterator('TC'):
    #Operations for every test case
    for cmd in (tc):
        if cmd.tag == 'FileName':
            filename = str(cmd.text)
            # name of the file
        if cmd.tag == 'FileAttributes':
            fileattr = int(cmd.text)
            # file attribute value
            fh = handle.CreateFileA(filename,7,7,None,1,fileattr,None)
            handle.CloseHandle(fh)

